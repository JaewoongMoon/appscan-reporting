<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jwmoon.appscan.mapper.VulnerabilityMapper">
    <select id="selectVulnerabilities" resultType="Vulnerability" >  
    <![CDATA[ 
       SELECT a.ID as id, 
       		a.VULNERABILITYID as vulnerabilityId, 
       		a.REPENTITYID as repEntityId, 
       		a.VULNTYPEID as vulnTypeId, 
       		a.TESTURL as testUrl, 
       		a.NORMALIZEDTESTURL as normalizedTestUrl, 
       		a.SOURCEFLAGS as sourceFlags, 
       		a.ISINTERNAL as isInternal
		FROM VULNERABILITY_J a
    ]]>
    </select>
 	<select id="selectVulnerableUrls" resultType="Map">
 	SELECT distinct a.TESTURL
 		-- , a.NORMALIZEDTESTURL
	FROM VULNERABILITY_J a
 	</select>
 	
 	<!-- 취약한 URL 목록..  -->
 	<select id="selectIssueFiles">
 	SELECT a.ID, a.FILENAME, a.PARENTID, a.NISSUES, a.NREMEDIATIONS, a.NVARIANTS, a.VIEWTYPE, a.NVISITEDLINKS, a.NFAILEDREQUESTS
	    , b.PATH || b.NAME || a.FILENAME as fullPath
	FROM ASSTD_FILES a,
	     ASSTD_DIRS b
	where a.NISSUES != 0
	 and a.viewtype = 0
	 and a.PARENTID = b.ID
 	</select>
</mapper>
