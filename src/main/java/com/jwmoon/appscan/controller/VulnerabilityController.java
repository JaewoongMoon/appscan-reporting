/**
 * @ VulnerabilityController.java
 * 
 * Copyright 2016 NHN Techorus Corp. All rights Reserved. 
 * NHN Techorus PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
 */
package com.jwmoon.appscan.controller;

import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import com.jwmoon.appscan.mapper.VulnerabilityMapper;
import com.jwmoon.appscan.model.Vulnerability;

/**
 * <pre>
 * com.jwmoon.appscan.controller
 * VulnerabilityController.java 
 * </pre>
 *
 * @brief	: 
 * @author	: 문재웅(jwmoon@nhn-techorus.com)
 * @Date	: 2016. 7. 29.
 */
@Controller
@RequestMapping("/vulnerability")
public class VulnerabilityController {
	
	@Autowired
	VulnerabilityMapper vulnerabilityMapper;
	
	
	@RequestMapping("/select")
	public @ResponseBody List<Vulnerability> getVulnerabilityTypes(){
		return vulnerabilityMapper.selectVulnerabilities();
	}
	 
	@RequestMapping("/getVulnerableUrls")
	public @ResponseBody List<Map<String, String>> getVulnerableUrls(){
		return vulnerabilityMapper.selectVulnerableUrls();
	}
	
	@RequestMapping("/getVulnerableUrlsCount")
	public @ResponseBody Integer getVulnerableUrlsCount(){
		return vulnerabilityMapper.selectVulnerableUrls().size(); 
	} 
	 
	@RequestMapping("/index")
	public String getIndex(HttpServletRequest request){
		List<Map<String, String>> list = vulnerabilityMapper.selectVulnerableUrls();
		request.setAttribute("list", list);
		return "/vulnerability/index";
	}
		
}
